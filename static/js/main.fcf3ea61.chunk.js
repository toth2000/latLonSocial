(this.webpackJsonplatlong=this.webpackJsonplatlong||[]).push([[0],{106:function(e,t,n){},107:function(e,t,n){},134:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(9),c=n.n(r),o=n(23),i=n(46),s=n(78),l=(n(106),n(29)),u=n(13),d=(n(107),n(177)),p=n(169),m=n(171),j=n(184),h=n(172),b=n(173),x=n(57),f=n(174),g=n(175),v=n(176),O=n(166),w=Object(O.a)({root:{width:"45%","@media screen and (max-width:800px)":{width:"70%"},"@media screen and (max-width:500px)":{width:"90%"}},media:{height:0,paddingTop:"56.25%"}}),y=n(4),k=function(e){var t=e.post,n=w();return Object(y.jsxs)(p.a,{className:n.root,maxWidth:"md",children:[Object(y.jsx)(m.a,{avatar:Object(y.jsx)(j.a,{"aria-label":"recipe",children:t.name[0]}),title:t.name,subheader:t.country}),t.image?Object(y.jsx)(h.a,{className:n.media,image:t.image}):null,Object(y.jsx)(b.a,{children:Object(y.jsx)(x.a,{variant:"body2",color:"textSecondary",component:"p",children:t.text})}),Object(y.jsxs)(f.a,{disableSpacing:!0,children:[Object(y.jsx)(g.a,{"aria-label":"like",children:Object(y.jsx)(v.a,{})}),Object(y.jsx)(x.a,{variant:"caption",children:"".concat(t.likes.length," likes")})]})]})},C=n(84),N=n.n(C),S=Object(O.a)({container:{gap:"25px",marginTop:"15px",marginBottom:"45px"},mainContainer:{position:"absolute",height:"100%",width:"100%"},avatar:{cursor:"pointer",width:"64px",height:"64px",backgroundColor:"#3f51b5",position:"fixed",bottom:"55px",right:"55px","@media screen and (max-width:500px)":{width:"48px",height:"48px",bottom:"25px",right:"25px"}}}),W=n(11),E=n.n(W),I=n(19),P="CREATE",L="FETCH",B="LIKE",T=n(37),U=n.n(T),q="https://latlongsocial.herokuapp.com",F=U.a.create({baseURL:q});F.interceptors.request.use((function(e){return localStorage.getItem("profile")&&(e.headers.authorization="Bearer ".concat(JSON.parse(localStorage.getItem("profile")).token)),e}));var J=function(e){return F.post("/posts",e)},A=function(e){return function(){var t=Object(I.a)(E.a.mark((function t(n){var a,r,c,o;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,J(e);case 3:a=t.sent,r=a.data,n({type:P,payload:r}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.log("Post action createPost",t.t0),alert(null===t.t0||void 0===t.t0||null===(c=t.t0.response)||void 0===c||null===(o=c.data)||void 0===o?void 0:o.message);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},G=n(178),R=function(){var e=Object(I.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){navigator.geolocation.getCurrentPosition((function(t){var n={lat:t.coords.latitude,lon:t.coords.longitude};e(n)}),(function(e){console.log("Location getLocation",e),alert("Unable to fetch currenty location"),t(null)}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(I.a)(E.a.mark((function e(t){var n,a,r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lat,a=t.lon,e.prev=1,e.next=4,U.a.get("https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=".concat(n,"&longitude=").concat(a,"&localityLanguage=en"));case 4:return r=e.sent,c=r.data,e.abrupt("return",c.countryName);case 9:return e.prev=9,e.t0=e.catch(1),console.log("Location getCountry Name",e.t0),alert("Unable to fetch current location"),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=S(),t=Object(o.b)(),n=Object(o.c)((function(e){return e.posts})).posts;return Object(a.useEffect)((function(){R().then((function(e){return t((n=e,function(){var e=Object(I.a)(E.a.mark((function e(t){var a,r,c,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i=n.lat,s=n.lon,F.get("/posts/".concat(i,"/").concat(s));case 3:a=e.sent,r=a.data,t({type:L,payload:r}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Post action getPost",e.t0),alert(null===e.t0||void 0===e.t0||null===(c=e.t0.response)||void 0===c||null===(o=c.data)||void 0===o?void 0:o.message);case 12:case"end":return e.stop()}var i,s}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()));var n}))}),[]),Object(y.jsxs)("div",{className:e.mainContainer,children:[Object(y.jsx)(d.a,{className:e.container,container:!0,direction:"column",justifyContent:"space-between",alignItems:"center",children:n&&0!==n.length?Object(y.jsx)(y.Fragment,{children:n.map((function(e){return Object(y.jsx)(k,{post:e},e._id)}))}):Object(y.jsx)(G.a,{})}),Object(y.jsx)(j.a,{className:e.avatar,component:l.b,to:"/posts",children:Object(y.jsx)(N.a,{})})]})},z=n(32),H=n(179),K=n(180),M=n(181),Q=n(88),V=n(185),X="".concat(q,"/auth"),Y=function(e){var t=e.email,n=e.password;return U.a.post("".concat(X,"/signIn"),{email:t,password:n})},Z=function(e){var t=e.name,n=e.email,a=e.password,r=e.confirmPassword;return U.a.post("".concat(X,"/signUp"),{name:t,email:n,password:a,confirmPassword:r})},$="AUTH",ee="LOGOUT",te=n(85),ne=Object(O.a)({title:{color:"#FFF",textDecoration:"none"},toolbar:{display:"flex",justifyContent:"space-between"},userBox:{display:"flex",gap:"25px",alignItems:"center"},userName:{"@media screen and (max-width:800px)":{display:"none"}},avatar:{cursor:"pointer"}}),ae=function(){var e,t,n=ne(),r=Object(o.b)(),c=Object(a.useState)(null),i=Object(z.a)(c,2),s=i[0],u=i[1],d=Object(a.useState)({open:!1,anchorE1:null}),p=Object(z.a)(d,2),m=p[0],h=p[1],b=Object(o.c)((function(e){return e.auth}));Object(a.useEffect)((function(){try{h({open:!1,anchorE1:null}),u(JSON.parse(localStorage.getItem("profile")));var e=s.token;1e3*Object(te.a)(e).exp<(new Date).getTime()&&f()}catch(t){console.log("Appbar useEffect error",t)}}),[b]);var f=function(){r(function(){var e=Object(I.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t({type:ee})}catch(n){console.log("Log Out Action",n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return Object(y.jsx)(H.a,{position:"sticky",children:Object(y.jsxs)(K.a,{className:n.toolbar,children:[Object(y.jsx)(x.a,{className:n.title,component:l.b,to:"/",variant:"h6",children:"LatLon Social"}),null===s?Object(y.jsx)(M.a,{component:l.b,to:"/auth",variant:"contained",color:"secondary",children:"Login"}):Object(y.jsxs)("div",{className:n.userBox,children:[Object(y.jsx)(x.a,{variant:"h6",className:n.userName,children:null===(e=s.result)||void 0===e?void 0:e.name}),Object(y.jsx)(j.a,{className:n.avatar,"aria-controls":"simple-menu","aria-haspopup":"false",onClick:function(e){h({open:!0,anchorE1:e.currentTarget})},children:null===(t=s.result)||void 0===t?void 0:t.name[0]}),Object(y.jsx)(Q.a,{id:"simple-menu",anchorEl:m.anchorE1,keepMounted:!0,open:Boolean(m.open),onClose:function(){h({open:!1,anchorE1:null})},children:Object(y.jsx)(V.a,{onClick:f,children:"Logout"})})]})]})})},re=n(56),ce=n(18),oe=n(182),ie=n(86),se=n.n(ie),le=n(183),ue=Object(O.a)({grid:{height:"90vh"},infoGrid:{gap:"18px",marginBottom:"25px"},container:{paddingTop:"25px",paddingBottom:"25px",backgroundColor:"white",borderRadius:"15px","@media screen and (max-width: 1000px)":{maxWidth:"90%"}},buttonContainer:{marginTop:"25px","& Button":{marginBottom:"8px"}},avatar:{height:"48px",width:"48px"},input:{marginBottom:"8px"}}),de=function(e){var t=e.handleChange,n=ue();return Object(y.jsxs)(oe.a,{maxWidth:"sm",children:[Object(y.jsx)(le.a,{className:n.input,name:"email",label:"Email",margin:"dense",type:"email",variant:"outlined",fullWidth:!0,required:!0,onChange:function(e){return t(e)}}),Object(y.jsx)(le.a,{className:n.input,name:"password",label:"Password",margin:"dense",type:"password",variant:"outlined",fullWidth:!0,required:!0,onChange:function(e){return t(e)}})]})},pe=function(e){var t=e.handleChange,n=ue();return Object(y.jsxs)(oe.a,{maxWidth:"sm",children:[Object(y.jsx)(le.a,{className:n.input,name:"name",label:"Full Name",margin:"dense",variant:"outlined",fullWidth:!0,required:!0,onChange:function(e){return t(e)}}),Object(y.jsx)(le.a,{className:n.input,name:"email",label:"Email",margin:"dense",type:"email",variant:"outlined",fullWidth:!0,required:!0,onChange:function(e){return t(e)}}),Object(y.jsx)(le.a,{className:n.input,name:"password",label:"Password",margin:"dense",variant:"outlined",fullWidth:!0,type:"password",required:!0,onChange:function(e){return t(e)}}),Object(y.jsx)(le.a,{className:n.input,name:"confirmPassword",label:"Confirm Password",margin:"dense",variant:"outlined",fullWidth:!0,required:!0,onChange:function(e){return t(e)}})]})},me=function(){var e=ue(),t=Object(u.f)(),n=Object(o.b)(),r=Object(a.useState)(!1),c=Object(z.a)(r,2),i=c[0],s=c[1],l=Object(a.useState)({name:"",email:"",password:"",confirmPassword:""}),p=Object(z.a)(l,2),m=p[0],h=p[1],b=function(e){h(Object(ce.a)(Object(ce.a)({},m),{},Object(re.a)({},e.target.name,e.target.value)))};return Object(y.jsx)(d.a,{className:e.grid,container:!0,direction:"column",justifyContent:"center",alignItems:"center",children:Object(y.jsxs)(oe.a,{className:e.container,maxWidth:"sm",children:[Object(y.jsxs)(d.a,{className:e.infoGrid,container:!0,direction:"column",justifyContent:"center",alignItems:"center",children:[Object(y.jsx)(j.a,{className:e.avatar,children:Object(y.jsx)(se.a,{})}),Object(y.jsx)(x.a,{variant:"h5",children:i?"Sign Up":"Sign In"})]}),i?Object(y.jsx)(pe,{handleChange:b}):Object(y.jsx)(de,{handleChange:b}),Object(y.jsxs)(oe.a,{className:e.buttonContainer,maxWidth:"sm",children:[Object(y.jsx)(M.a,{variant:"contained",fullWidth:!0,color:"secondary",full:!0,onClick:function(){n(i?function(e,t){var n=e.name,a=e.email,r=e.password,c=e.confirmPassword;return function(){var e=Object(I.a)(E.a.mark((function e(o){var i,s,l,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z({name:n,email:a,password:r,confirmPassword:c});case 3:i=e.sent,s=i.data,o({type:$,payload:s}),t.push("/"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Sign Up action",e.t0.response),alert(null===e.t0||void 0===e.t0||null===(l=e.t0.response)||void 0===l||null===(u=l.data)||void 0===u?void 0:u.message);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()}(m,t):function(e,t){var n=e.email,a=e.password;return function(){var e=Object(I.a)(E.a.mark((function e(r){var c,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y({email:n,password:a});case 3:c=e.sent,o=c.data,r({type:$,payload:o}),t.push("/"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Sign In action",e.t0.response),alert(null===e.t0||void 0===e.t0||null===(i=e.t0.response)||void 0===i||null===(s=i.data)||void 0===s?void 0:s.message);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()}(m,t))},children:i?"Sign Up":"Login"}),Object(y.jsx)(M.a,{variant:"contained",color:"primary",fullWidth:!0,onClick:function(){h({name:"",email:"",password:"",confirmPassword:""}),s((function(e){return s(!e)}))},children:i?"Already have an account? Sign In":"Create a new account"})]})]})})},je=n(87),he=n.n(je),be=Object(O.a)({grid:{height:"80vh"},container:{backgroundColor:"#fff",padding:"35px",borderRadius:"15px","@media screen and (max-width:800px)":{maxWidth:"70%"},"@media screen and (max-width:500px)":{maxWidth:"95%"}},heading:{marginBottom:"25px","@media screen and (max-width:500px)":{fontSize:"25px"}},file:{width:"100%"},rowGrid:{gap:"8px"},button:{marginTop:"25px"}}),xe=function(){var e,t,n=be(),r=Object(o.b)(),c=Object(u.f)(),i=JSON.parse(localStorage.getItem("profile")),s=Object(a.useState)({name:null===i||void 0===i||null===(e=i.result)||void 0===e?void 0:e.name,userId:null===i||void 0===i||null===(t=i.result)||void 0===t?void 0:t._id,text:"",image:"",lat:"",lon:"",country:""}),l=Object(z.a)(s,2),p=l[0],m=l[1],j=function(){var e=Object(I.a)(E.a.mark((function e(){var t,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,_(t);case 7:if(n=e.sent){e.next=10;break}return e.abrupt("return");case 10:m(Object(ce.a)(Object(ce.a)({},p),{},{lat:t.lat,lon:t.lon,country:n}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){j()}),[]);var h=function(){var e=Object(I.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("data",p),r(A(p)),c.push("/");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.jsx)(d.a,{className:n.grid,container:!0,direction:"column",justifyContent:"center",alignItems:"center",children:Object(y.jsx)(oe.a,{className:n.container,maxWidth:"xs",children:Object(y.jsxs)(d.a,{className:n.rowGrid,container:!0,direction:"column",justifyContent:"center",alignItems:"center",children:[Object(y.jsx)(x.a,{className:n.heading,variant:"h4",children:"Create a new post"}),Object(y.jsx)(le.a,{name:"text",label:"Enter Text",variant:"outlined",onChange:function(e){return t=e,void m(Object(ce.a)(Object(ce.a)({},p),{},{text:t.target.value}));var t},fullWidth:!0}),Object(y.jsx)("div",{className:n.file,children:Object(y.jsx)(he.a,{type:"file",multiple:!1,onDone:function(e){var t=e.base64;return m(Object(ce.a)(Object(ce.a)({},p),{},{image:t}))}})}),Object(y.jsx)(M.a,{className:n.button,variant:"contained",color:"secondary",fullWidth:!0,onClick:h,children:"Submit"})]})})})};var fe=function(){return Object(y.jsxs)(l.a,{basename:"/latLon",children:[Object(y.jsx)(ae,{}),Object(y.jsxs)(u.c,{children:[Object(y.jsx)(u.a,{exact:!0,path:"/",component:D}),Object(y.jsx)(u.a,{exact:!0,path:"/auth",component:me}),Object(y.jsx)(u.a,{exact:!0,path:"/posts",component:xe})]})]})},ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{result:null,token:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $:return localStorage.setItem("profile",JSON.stringify(t.payload)),Object(ce.a)(Object(ce.a)({},e),{},{result:t.payload.result,token:t.payload.token});case ee:return localStorage.clear(),Object(ce.a)(Object(ce.a)({},e),{},{result:null,token:null});default:return e}},ve=n(89),Oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return t.payload;case P:return[].concat(Object(ve.a)(e),[t.payload]);case B:return e.map((function(e){return e._id===t.payload._id?t.payload:e}));default:return e}},we=Object(i.b)({auth:ge,posts:Oe}),ye=Object(i.d)(we,Object(i.c)(Object(i.a)(s.a)));c.a.render(Object(y.jsx)(o.a,{store:ye,children:Object(y.jsx)(fe,{})}),document.getElementById("root"))}},[[134,1,2]]]);
//# sourceMappingURL=main.fcf3ea61.chunk.js.map